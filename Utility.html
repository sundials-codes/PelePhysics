<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Utility &mdash; PelePhysics 2022.10 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="Tutorials.html" />
    <link rel="prev" title="Equation of State" href="EOS.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PelePhysics
          </a>
              <div class="version">
                2022.10
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html"><cite>PelePhysics</cite> Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chemistry.html">Chemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="Transport.html">Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="EOS.html">Equation of State</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#premixed-flame-initialization">Premixed Flame Initialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generating-a-pmf-file">Generating a PMF file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#turbulent-inflows">Turbulent Inflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generating-a-turbulence-file">Generating a turbulence file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plt-file-management">Plt File Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="#diagnostics">Diagnostics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="DeveloperGuide.html">Developer Guidelines</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PelePhysics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Utility</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Utility.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="utility">
<span id="sec-utility"></span><h1>Utility<a class="headerlink" href="#utility" title="Permalink to this heading"></a></h1>
<p>In addition to routines for evaluating chemical reactions, transport properties, and equation of state functions, PelePhysics includes other shared utilities that are utilized by both PeleC and PeleLM(eX). These utilities include support for:</p>
<ul class="simple">
<li><p>Premixed Flame (<code class="docutils literal notranslate"><span class="pre">PMF</span></code>) initialization from precomputed 1D flame profiles</p></li>
<li><p>Turbulent inflows (<code class="docutils literal notranslate"><span class="pre">TurbInflow</span></code>) on domain boundaries from saved turbulence data</p></li>
<li><p>Plt file management (<code class="docutils literal notranslate"><span class="pre">PltFileManager</span></code>)</p></li>
<li><p>Output of runtime <code class="docutils literal notranslate"><span class="pre">Diagnostics</span></code></p></li>
</ul>
<p>This section provides relevant notes on using these utilities across the Pele family of codes. There may be additional subtleties based on the code-specific implementation of these capabilities, in which case it will be necessary to refer to the documentation of the code of interest.</p>
<section id="premixed-flame-initialization">
<h2>Premixed Flame Initialization<a class="headerlink" href="#premixed-flame-initialization" title="Permalink to this heading"></a></h2>
<p>Pre-computed profiles from 1D freely propogating premixed flames are used to initialize a wrinkled <a class="reference external" href="https://amrex-combustion.github.io/PeleLMeX/manual/html/Tutorials_FlameSheet.html">flamesheet</a> in PeleLMeX, among other problems. Right now, this capability is not used in PeleC, but similar code that accomplishes the same task using data files of the same format is applied in PeleC. The code has two parts, a data container defined in <code class="docutils literal notranslate"><span class="pre">PMFData.{H,cpp}</span></code> that loads and stores data from the pre-computed profile, and a function defined in <code class="docutils literal notranslate"><span class="pre">PMF.H</span></code> that, when provided this data structure and ther bounds of a cell of interest, returns temperature, velocity, and mole fractions from that location.</p>
<p>This code has two runtime parameters that may be set in the input file:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>pmf.datafile = pmf.dat
pmf.do_cellAverage = 1
</pre></div>
</div>
<p>The first parameter specifies the path to the PMF data file. This file contains a two-line header followed by whitespace-delimited data columns in the order: position (cm), temperature (K), velocity (cm/s), density(g/cm3), species mole fractions. Sample files are provided in the relevant PeleLMeX (and PeleC) examples, and the procedure to generate these files with a provided script is described below. The second parameter specifies whether the PMF code does a finite volume-style integral over the querried cell (<code class="docutils literal notranslate"><span class="pre">pmf.do_cellAverage</span> <span class="pre">=</span> <span class="pre">1</span></code>) or whether the code finds an interpolated value at the midpoint of the querried cell (<code class="docutils literal notranslate"><span class="pre">pmf.do_cellAverage</span> <span class="pre">=</span> <span class="pre">0</span></code>)</p>
<section id="generating-a-pmf-file">
<h3>Generating a PMF file<a class="headerlink" href="#generating-a-pmf-file" title="Permalink to this heading"></a></h3>
<p>The script <code class="docutils literal notranslate"><span class="pre">cantera_pmf_generator.py</span></code> solves a 1D unstrained premixed flame using <a class="reference external" href="https://doi.org/10.5281/zenodo.6387882">Cantera</a> and saves it in the appropriate file format for use by the Pele codes. To use this script, first follow the <a class="reference internal" href="Ceptr.html#sec-ceptr-software"><span class="std std-ref">CEPTR instructions</span></a> for setting up <code class="docutils literal notranslate"><span class="pre">poetry</span></code>. Then return to the <code class="docutils literal notranslate"><span class="pre">Utility/PMF/</span></code> directory and run the script:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>poetry -C ../../Support/ceptr/ run python cantera_pmf_generator.py -m dodecane_lu -f NC12H26 -d 0.01 -o ./
</pre></div>
</div>
<p>This example computes a dodecane/air flame using the <code class="docutils literal notranslate"><span class="pre">dodecane_lu</span></code> mechanism on a 0.01 m domain, and saves the resulting file to the present directory. You may choose any mechanism included with PelePhysics, as the Cantera <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> format is included for all mechanisms. If you choose a reduced mechanism with QSS species, the 1D solution will be obtained using the skeletal version of the mechanism without QSS species being remove, as Cantera does not support QSS by default. In this case, the script will also save a data file with QSS species removed (ending in <code class="docutils literal notranslate"><span class="pre">-qssa-removed.dat</span></code>) that is suitable for use with the QSS mechanisms in Pele. A range of additional conditions may be specified at the command line. To see the full set of options, use the help feature:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>poetry -C ../../Support/ceptr/ run python cantera_pmf_generator.py --help
</pre></div>
</div>
<p>Note that when running Cantera, you may need to adjust the domain size to be appropriate for your conditions in order for the solver to converge. At times, you may also need to adjust the solver tolerances and other parameters that are specified within the script.</p>
<p>An additional script is provided to allow plotting of the PMF solutions. This script is used as follows (if no variable index is specified, temperature is plotted by default):</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>poetry -C ../../Support/ceptr/ run python plotPMF.py &lt;pmf-file&gt; &lt;variable-index&gt;
</pre></div>
</div>
</section>
</section>
<section id="turbulent-inflows">
<h2>Turbulent Inflows<a class="headerlink" href="#turbulent-inflows" title="Permalink to this heading"></a></h2>
<p>Placeholder. PelePhysics supports the capability of the flow solvers to have spatially and temporally varying inflow conditions based on precomputed turbulence data.</p>
<section id="generating-a-turbulence-file">
<h3>Generating a turbulence file<a class="headerlink" href="#generating-a-turbulence-file" title="Permalink to this heading"></a></h3>
<p>A python script is used to generate a synthetic turbulence spectrum.</p>
</section>
</section>
<section id="plt-file-management">
<h2>Plt File Management<a class="headerlink" href="#plt-file-management" title="Permalink to this heading"></a></h2>
<p>This code contains data structures used to handle data read from plt files that is utilized by the routines that allow the code to be restarted based on data from plt files.</p>
</section>
<section id="diagnostics">
<h2>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this heading"></a></h2>
<p>Placeholder. Once the porting of diagnostics from PeleLMeX to PelePhysics/PeleC is complete, documentation can be added here.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="EOS.html" class="btn btn-neutral float-left" title="Equation of State" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright AMReX Copyright (c) 2022, The Regents of the University of California, through Lawrence Berkeley National Laboratory and the Alliance for Sustainable Energy, LLC., through National Renewable Energy Laboratory (subject to receipt of any required approvals from the U.S. Dept. of Energy).  All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>